<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>System Update</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000000;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column; /* 縦並びにする */
            justify-content: center;
            align-items: center;
            touch-action: none;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; /* OS標準フォント */
            user-select: none; /* テキスト選択禁止 */
            -webkit-user-select: none;
        }

        canvas {
            display: block;
            /* スピナーとテキストのバランス調整 */
            margin-bottom: 40px; 
        }

        .message {
            color: #ffffff;
            font-size: 16px;
            font-weight: 400;
            text-align: center;
            opacity: 0.9;
            letter-spacing: 0.5px;
        }

        /* プログレスバー（オプション：更にそれっぽくするなら） */
        .progress-bar {
            width: 200px;
            height: 3px;
            background-color: #333;
            border-radius: 2px;
            margin-top: 20px;
            overflow: hidden;
            display: none; /* シンプル派の場合は非表示、必要ならblockに */
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background-color: #fff;
            animation: fillProgress 30s linear forwards;
        }

        @keyframes fillProgress {
            0% { width: 0%; }
            30% { width: 15%; }
            50% { width: 15%; } /* ちょっと止まる演出 */
            60% { width: 40%; }
            100% { width: 90%; }
        }
    </style>
</head>
<body>

    <canvas id="spinnerCanvas"></canvas>
    
    <div class="message">システムを更新しています...<br><span style="font-size: 12px; color: #888;">電源を切らないでください</span></div>

    <!-- プログレスバーが必要な場合はコメントアウトを外してください -->
    <!-- 
    <div class="progress-bar">
        <div class="progress-fill"></div>
    </div> 
    -->

    <script>
        const canvas = document.getElementById('spinnerCanvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let centerX, centerY;

        // 設定（少しサイズを調整）
        const config = {
            count: 12,
            radius: 24,       // 少し小さめに
            dotRadius: 3.5,   // 少し小さめに
            color: '#d1d1d6', // 真っ白より少しグレーがかったiOS/Android標準色っぽさ
            speed: 0.15
        };

        let frame = 0;

        function resize() {
            // フルスクリーン時のちらつき防止のため少し大きめに確保する手もあるが、今回は標準で
            width = window.innerWidth;
            height = window.innerHeight; // canvas自体の大きさは画面いっぱいにはしないが、計算用
            
            // Canvas表示サイズは固定（スマホ画面中央に配置するため）
            const displaySize = 100; // 100x100の領域
            const dpr = window.devicePixelRatio || 1;
            
            canvas.width = displaySize * dpr;
            canvas.height = displaySize * dpr;
            canvas.style.width = displaySize + 'px';
            canvas.style.height = displaySize + 'px';
            
            ctx.scale(dpr, dpr);
            
            // 描画の中心
            centerX = displaySize / 2;
            centerY = displaySize / 2;
        }

        function animate() {
            // キャンバス全体をクリア
            ctx.clearRect(0, 0, canvas.width / (window.devicePixelRatio || 1), canvas.height / (window.devicePixelRatio || 1));

            frame += config.speed;
            const step = Math.floor(frame); 

            for (let i = 0; i < config.count; i++) {
                ctx.save();
                ctx.translate(centerX, centerY);
                const angle = (Math.PI * 2 * i) / config.count;
                ctx.rotate(angle);

                let distance = (i - step) % config.count;
                if (distance < 0) distance += config.count;

                let alpha = 1 - (distance / config.count);
                alpha = Math.max(alpha, 0.1); 

                ctx.fillStyle = config.color;
                ctx.globalAlpha = alpha;

                ctx.beginPath();
                ctx.arc(config.radius, 0, config.dotRadius, 0, Math.PI * 2);
                ctx.fill();

                ctx.restore();
            }

            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', resize);
        resize();
        animate();

        // ---------------------------------------------------------
        // リアリティ向上機能: タップでフルスクリーン化
        // ---------------------------------------------------------
        document.body.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
                });
            } else {
                document.exitFullscreen();
            }
        });

    </script>
</body>
</html>